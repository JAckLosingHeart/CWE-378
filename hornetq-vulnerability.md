## Vulnerability Description:

The vulnerability is caused by insecure usage of the `File.createTempFile` method in Java, which can lead to unintended consequences such as information disclosure, file overwrite, etc. The `File.createTempFile` method is designed to create a temporary file. However, if the method is used without proper validation or in a shared directory with weak permissions, an attacker may exploit the predictable file name or gain access to the temporary file. For example, on Linux systems, the temporary file is created under `/tmp` folder by default with permission `-rw-r--r--` when java.io.tmpdir is not set to another directory with restricted access

## Details

https://github.com/hornetq/hornetq/blob/HornetQ_2_4_9_Final/hornetq-core-client/src/main/java/org/hornetq/core/client/impl/ClientConsumerImpl.java#L665C35-L665C49

![image-20240924233040738](C:\Users\samym\AppData\Roaming\Typora\typora-user-images\image-20240924233040738.png)

File.createTempFile is used during compressed message handling, which may cause information leak if handled messages contains sensitive information



## Mitigation

Consider using

1. `public static File createTempFile(String prefix, String suffix, File directory)` to at least specify a directory with restrict acccess

   Or

2. createTempFile function under nio.Files 

   `public static Path createTempFile(String prefix, String suffix, FileAttribute<?>... attrs)`

   to explicitly specify file permissions when creating a temporary file